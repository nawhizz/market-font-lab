# Technical Requirements Document (TRD): 대조시장 폰트 체험 웹페이지

## 1. 기술 개요 (Technical Overview)

- **프로젝트 목표:** PRD의 비즈니스 목표(폰트 홍보)를 달성하기 위해, 빠르고 안정적이며 저비용으로 운영 가능한 싱글 페이지 애플리케이션(SPA)을 구축한다.
    
- **핵심 기술 과제:**
    - 웹폰트의 최적화된 로딩 (FOUC 방지).
    - 사용자 스타일(CSS)을 텍스트와 함께 DB에 저장하고 처리하는 로직 구현.
    - 별도 인증 없는 API의 스팸 방지 처리.
        
- **관련 문서:** [상기 PRD 링크], [대조시장 브랜딩 가이드라인 링크]

## 2. 시스템 아키텍처 (System Architecture)

- **아키텍처 목표:** 서버리스(Serverless) 아키텍처를 기반으로 개발 속도를 높이고, 인프라 관리 비용을 최소화하며, 트래픽 급증에 유연하게 대응한다.
    
- **고수준 아키텍처 다이어그램:**
    
    > [User (Browser)]
    > 
    > |
    > 
    > v
    > 
    > [Frontend (Static Site - Vercel/Netlify)] (웹폰트, 이미지 포함)
    > 
    > |
    > 
    > v (API Call: POST /api/memo)
    > 
    > [Backend (Serverless Function - Vercel/Netlify Functions)]
    > 
    > |
    > 
    > v (Create Data)
    > 
    > [Database (BaaS - Firebase Firestore / Supabase)]
    
- **핵심 컴포넌트 설명:**
    
    - **Frontend:** 사용자가 보는 UI. React(Next.js)를 사용한 정적 사이트(SSG)로 빌드하여 CDN을 통해 제공.
        
    - **Backend:** '저장하기' 요청을 처리하는 간단한 API. Vercel/Netlify의 서버리스 함수를 사용.
        
    - **Database:** 사용자 메모를 저장하는 NoSQL 또는 관계형 DB. (Supabase의 PostgreSQL 추천)
        

## 3. 기술 스택 (Technology Stack)

| **구분**     | **기술 / 라이브러리**                                | **선택 사유**                                                        |
| ---------- | --------------------------------------------- | ---------------------------------------------------------------- |
| **프론트엔드**  | React (Next.js)                               | SPA 및 SSG 구현이 용이하며, API 라우트(백엔드) 통합 개발 가능.                       |
| **백엔드**    | Next.js API Routes (Node.js)                  | 프론트엔드 프레임워크에 내장되어 있어 별도 서버 구축 없이 API 개발 가능.                      |
| **데이터베이스** | **Supabase (PostgreSQL)**                     | 관계형 구조가 명확하며, 넉넉한 무료 플랜 제공. JSONB 타입으로 스타일 저장 용이.                |
| **인프라**    | **Vercel**                                    | Next.js와 최적의 궁합. Git 푸시(Push)만으로 자동 배포(CI/CD) 및 CDN, 서버리스 함수 제공. |
| **기타**     | CSS-in-JS (Styled-components) 또는 Tailwind CSS | 동적 스타일(색상, 크기) 적용 및 관리가 용이함.                                     |

## 4. 데이터 모델 및 관리 (Data Model & Management)

- **ERD (Entity-Relationship Diagram):** 단일 테이블 구조.
    
    > [memos]
    > PK id (uuid)
    > created_at (timestamp)
    > content (text)
    > styles (jsonb)
    > bg_color (varchar)
    
- **주요 테이블 스키마 정의:**
    
    - `memos`: 사용자가 저장한 메모
        - `id`: 고유 식별자 (UUID, Primary Key)
        - `created_at`: 생성 시간 (Timestamp with time zone)
        - `content`: 사용자가 입력한 텍스트 (Text)
        - `styles`: 폰트 스타일 정보 (JSONB)
            - _예시:_ `{ "color": "#FF0000", "fontSize": "24px", "fontWeight": "bold", "fontStyle": "italic" }`
        - `bg_color`: 메모창 배경색 (VARCHAR) (예: `#FFFF00`)
            
- **데이터 백업:** Supabase/Firebase에서 제공하는 자동 백업 정책 활용.

## 5. API 명세 (API Specification)

- **인증 방식:** 없음 (Public API)
- **API 문서 링크:** (별도 Swagger/Postman 생성 예정)
- **주요 API 엔드포인트 목록:**
    - **`POST /api/memos` (메모 생성)**
        - **Description:** 사용자가 작성한 메모와 스타일을 DB에 저장합니다.
        - **Request Body (JSON):**
			```json
			{
			  "content": "대조시장 폰트!",
			  "styles": {
			    "color": "#333333",
			    "fontSize": "20px",
			    "fontWeight": "normal",
			    "fontStyle": "normal"
			  },
			  "bg_color": "#FFFFFF"
			}
			```
		- **Success Response (201 Created):**
			```json
			{
			  "id": "a1b2c3d4-...",
			  "created_at": "2025-11-12T05:08:00Z",
			  "message": "Memo saved successfully."
			}
			```

		- **Error Response (400 Bad Request):** (입력값이 유효하지 않을 때)
		- **Error Response (429 Too Many Requests):** (단시간에 너무 많은 요청 시)


## 6. 주요 비기능 요구사항 (Key Non-Functional Requirements)

- **보안:**
    - `POST /api/memos` API에 **API Rate Limiting** (IP 기준 분당 요청 횟수 제한) 적용.
    - DB 저장 시 `content` 필드에 대해 **XSS 방지 라이브러리** (예: `DOMPurify` 클라이언트 측, 또는 백엔드에서 `sanitize-html`) 적용.
        
- **확장성:** Vercel 및 Supabase의 서버리스 아키텍처 사용으로 자동 확장(Auto-scaling) 대응.
    
- **성능:** 웹폰트 포맷은 `woff2`를 우선 사용하고, `font-display: swap;` 속성을 적용하여 FOUC(Flash of Unstyled Content)를 최소화하고 렌더링 차단을 방지함.
    
- **안정성:** 별도 서버가 없어 서버 다운타임 리스크가 낮음.

## 7. 인프라, 배포 및 모니터링 (Infrastructure, Deployment & Monitoring)

- **CI/CD 파이프라인:** Github/Gitlab 레포지토리의 `main` 브랜치에 푸시(Push) 시, Vercel이 자동으로 빌드 및 프로덕션 배포 실행.
    
- **서버 환경:**
    - `Production`: Vercel (main 브랜치)
    - `Staging`: Vercel (PR(Pull Request) 생성 시 자동 생성되는 프리뷰 URL)
- **모니터링 및 로깅:** Vercel Analytics (방문자 통계) 및 Vercel Logs (서버리스 함수 로그) 활용.
    

## 8. 기술적 리스크 및 해결 방안 (Technical Risks & Mitigation)

- **리스크:** (PRD와 동일) 인증 부재로 인한 스팸/악성 데이터 저장.
    
- **해결 방안:**
    - (기본) API Rate Limiting 적용.
    - (심화) 스팸이 문제될 경우, Cloudflare Turnstile (보이지 않는 Captcha) 또는 hCaptcha (무료 티어)를 '저장하기' 버튼에 연동.

## 9. 개발 마일스톤 (Development Milestones)

- **Sprint 1:**
    - 개발 환경 구축 (Next.js, Vercel, Supabase 세팅).
    - 웹폰트 적용 및 기본 UI (제목, 이미지, 메모창) 퍼블리싱.
    - 스타일 편집 툴바 기능 구현 (프론트엔드).
        
- **Sprint 2:**
    - Supabase `memos` 테이블 스키마 설계.
    - `POST /api/memos` API 엔드포인트 개발 (백엔드).
    - '저장하기' 버튼 연동 및 API 호출, 확인 메시지 처리.
    - 보안 처리 (XSS 방지, Rate Limiting 테스트).
